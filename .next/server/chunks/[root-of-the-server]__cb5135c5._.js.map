{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 21, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/edisa/Desktop/Personal/Portfolio/Portfolio/lib/firebaseAdmin.ts"],"sourcesContent":["import * as admin from 'firebase-admin';\r\n\r\nif (!admin.apps.length) {\r\n  admin.initializeApp({\r\n    credential: admin.credential.cert({\r\n      projectId: process.env.FIREBASE_PROJECT_ID,\r\n      privateKey: process.env.FIREBASE_PRIVATE_KEY?.replace(/\\\\n/g, '\\n'),\r\n      clientEmail: process.env.FIREBASE_CLIENT_EMAIL,\r\n    }),\r\n    databaseURL: process.env.FIREBASE_DATABASE_URL,\r\n  });\r\n}\r\n\r\nexport const db = admin.database();\r\nexport { admin };\r\n"],"names":[],"mappings":";;;AAAA;;AAEA,IAAI,CAAC,2HAAA,CAAA,OAAU,CAAC,MAAM,EAAE;IACtB,2HAAA,CAAA,gBAAmB,CAAC;QAClB,YAAY,2HAAA,CAAA,aAAgB,CAAC,IAAI,CAAC;YAChC,WAAW,QAAQ,GAAG,CAAC,mBAAmB;YAC1C,YAAY,QAAQ,GAAG,CAAC,oBAAoB,EAAE,QAAQ,QAAQ;YAC9D,aAAa,QAAQ,GAAG,CAAC,qBAAqB;QAChD;QACA,aAAa,QAAQ,GAAG,CAAC,qBAAqB;IAChD;AACF;AAEO,MAAM,KAAK,2HAAA,CAAA,WAAc","debugId":null}},
    {"offset": {"line": 57, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/edisa/Desktop/Personal/Portfolio/Portfolio/lib/verifyToken.ts"],"sourcesContent":["import { admin } from './firebaseAdmin';\r\n\r\nexport async function verifyIdToken(token: string) {\r\n  try {\r\n    const decodedToken = await admin.auth().verifyIdToken(token);\r\n    return decodedToken;\r\n  } catch (err) {\r\n    console.error('Token verification failed:', err);\r\n    return null;\r\n  }\r\n}\r\n"],"names":[],"mappings":";;;AAAA;AAAA;;AAEO,eAAe,cAAc,KAAa;IAC/C,IAAI;QACF,MAAM,eAAe,MAAM,4JAAA,CAAA,QAAK,CAAC,IAAI,GAAG,aAAa,CAAC;QACtD,OAAO;IACT,EAAE,OAAO,KAAK;QACZ,QAAQ,KAAK,CAAC,8BAA8B;QAC5C,OAAO;IACT;AACF","debugId":null}},
    {"offset": {"line": 76, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/edisa/Desktop/Personal/Portfolio/Portfolio/pages/api/heroPage.ts"],"sourcesContent":["import type { NextApiRequest, NextApiResponse } from 'next';\r\nimport { db } from '@/lib/firebaseAdmin';\r\nimport { verifyIdToken } from '@/lib/verifyToken';\r\nimport { HeroPage } from '@/types/HeroPage';\r\nimport { PersonalInfo } from '@/types/PersonalInfo';\r\nimport { Awards } from '@/types/Awards';\r\n\r\nconst now = () => new Date().toISOString();\r\n\r\nconst authenticate = async (req: NextApiRequest, res: NextApiResponse): Promise<boolean> => {\r\n  try {\r\n    const authHeader = req.headers.authorization;\r\n    if (!authHeader?.startsWith('Bearer ')) {\r\n      res.status(401).json({ error: 'Unauthorized: Missing or malformed token' });\r\n      return false;\r\n    }\r\n    const token = authHeader.split(' ')[1];\r\n    const decodedToken = await verifyIdToken(token);\r\n    if (!decodedToken) {\r\n      res.status(401).json({ error: 'Unauthorized: Invalid token' });\r\n      return false;\r\n    }\r\n    return true;\r\n  } catch (error) {\r\n    console.error('Authentication error:', error);\r\n    res.status(401).json({ error: 'Unauthorized' });\r\n    return false;\r\n  }\r\n};\r\n\r\nconst handleGet = async (_req: NextApiRequest, res: NextApiResponse) => {\r\n  try {\r\n    const heroSnapshot = await db.ref('heroPage').once('value');\r\n    const heroData = heroSnapshot.val() as Record<string, Omit<HeroPage, 'uid'>> | null;\r\n    const heroPage: HeroPage[] = heroData\r\n      ? Object.entries(heroData).map(([uid, data]) => ({ uid, ...data }))\r\n      : [];\r\n    const personalSnapshot = await db.ref('personalInfo').once('value');\r\n    const personalData = personalSnapshot.val() as Record<string, PersonalInfo> | null;\r\n    const personalInfo = personalData ? Object.values(personalData)[0] : {};\r\n    const awardsSnapshot = await db.ref('awards').once('value');\r\n    const awardsData = awardsSnapshot.val() as Record<string, Awards> | null;\r\n    const awards =\r\n      awardsData\r\n        ? Object.values(awardsData).reduce((acc, curr, index) => {\r\n            acc[index] = curr;\r\n            return acc;\r\n          }, {} as Record<number, Awards>)\r\n        : {};\r\n    const filesSnapshot = await db.ref('files').once('value');\r\n    const filesData = filesSnapshot.val() as Record<string, unknown> | null;\r\n    const files =\r\n      filesData\r\n        ? Object.values(filesData).reduce((acc: Record<number, unknown>, curr, index) => {\r\n            acc[index] = curr;\r\n            return acc;\r\n          }, {} as Record<number, unknown>)\r\n        : {};\r\n    const heroPageWithNested = heroPage.map(item => ({\r\n      ...item,\r\n      personalInfo,\r\n      awards,\r\n      files,\r\n    }));\r\n    return res.status(200).json(heroPageWithNested);\r\n  } catch (err: unknown) {\r\n    console.error('Error fetching heroPage, awards, or files:', err);\r\n    return res.status(500).json({ error: 'Internal Server Error' });\r\n  }\r\n};\r\n\r\nconst handlePost = async (req: NextApiRequest, res: NextApiResponse) => {\r\n  const { award, url } = req.body;\r\n  if (!award || !url) {\r\n    return res.status(400).json({ error: 'Missing required fields: award and url' });\r\n  }\r\n  try {\r\n    const ref = db.ref('heroPage').push();\r\n    const uid = ref.key;\r\n    if (!uid) {\r\n      return res.status(500).json({ error: 'Failed to generate award ID' });\r\n    }\r\n    await ref.set({\r\n      award,\r\n      url,\r\n      created_at: now(),\r\n      updated_at: now(),\r\n    });\r\n    return res.status(201).json({ message: 'Award added successfully', uid });\r\n  } catch (err: unknown) {\r\n    console.error('Error adding award:', err);\r\n    return res.status(500).json({ error: 'Internal Server Error' });\r\n  }\r\n};\r\n\r\nconst handlePut = async (req: NextApiRequest, res: NextApiResponse) => {\r\n  const { uid, award, url } = req.body;\r\n  if (!uid || !award || !url) {\r\n    return res.status(400).json({ error: 'Missing required fields: uid, award, and url' });\r\n  }\r\n  try {\r\n    await db.ref(`heroPage/${uid}`).update({\r\n      award,\r\n      url,\r\n      updated_at: now(),\r\n    });\r\n    return res.status(200).json({ message: 'Award updated successfully' });\r\n  } catch (err: unknown) {\r\n    console.error('Error updating award:', err);\r\n    return res.status(500).json({ error: 'Internal Server Error' });\r\n  }\r\n};\r\n\r\nconst handleDelete = async (req: NextApiRequest, res: NextApiResponse) => {\r\n  const { uid } = req.query;\r\n  if (!uid || typeof uid !== 'string') {\r\n    return res.status(400).json({ error: 'Missing or invalid uid in query' });\r\n  }\r\n  try {\r\n    await db.ref(`heroPage/${uid}`).remove();\r\n    return res.status(200).json({ message: 'Award deleted successfully' });\r\n  } catch (err: unknown) {\r\n    console.error('Error deleting award:', err);\r\n    return res.status(500).json({ error: 'Internal Server Error' });\r\n  }\r\n};\r\n\r\nexport default async function handler(req: NextApiRequest, res: NextApiResponse) {\r\n  const method = req.method || 'GET';\r\n  const protectedMethods = ['POST', 'PUT', 'DELETE'];\r\n  if (method === 'OPTIONS') {\r\n    res.setHeader('Allow', 'GET,POST,PUT,DELETE,OPTIONS');\r\n    return res.status(200).end();\r\n  }\r\n  if (protectedMethods.includes(method)) {\r\n    const isAuthenticated = await authenticate(req, res);\r\n    if (!isAuthenticated) return;\r\n  }\r\n  switch (method) {\r\n    case 'GET':\r\n      return handleGet(req, res);\r\n    case 'POST':\r\n      return handlePost(req, res);\r\n    case 'PUT':\r\n      return handlePut(req, res);\r\n    case 'DELETE':\r\n      return handleDelete(req, res);\r\n    default:\r\n      return res.status(405).json({ error: 'Method Not Allowed' });\r\n  }\r\n}\r\n"],"names":[],"mappings":"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","debugId":null}}]
}